import os
import sys
import shutil
from riche.console import Console

console = Console()

USER_APP_DIR = os.path.expanduser("~AppData/Local/Cantine Egalim") # Dossier père sur Linux et Windows
# USER_DATA_DIR = os.path.expanduser("~/Library/Application Support/Cantine Egalim") # Dossier père sur MacOS
MODELES_DIR = os.path.join(USER_APP_DIR, "modeles") # sous-dossier pour les modèles de machine learning
PARAMETRES_DIR = os.path.join(USER_APP_DIR, "parametres") # sous-dossier pour les paramètres pour le traitement
GUI_DIR = os.path.join(USER_APP_DIR, "gui") # sous-dossier pour les fichiers graphiques
BD_DIR = os.path.join(USER_APP_DIR, "bases_de_donnees") # sous-dossier pour les bases de données
chemin_bd_entrainement = os.path.join(BD_DIR, "bd_entrainement.db") # chemin vers la base de données d'entrainement
chemin_bd_produits = os.path.join(BD_DIR, "bd_produits.db") # chemin vers la base de données des produits

os.mkdir(USER_APP_DIR, exist_ok=True)
os.mkdir(MODELES_DIR, exist_ok=True)
os.mkdir(PARAMETRES_DIR, exist_ok=True)
os.mkdir(GUI_DIR, exist_ok=True)
os.mkdir(BD_DIR, exist_ok=True)

def resourse_path (relative_path):
    if hasattr(sys, '_MEIPASS'): # si le programme est empaqueté (.exe)
        base_path = sys._MEIPASS
    else: # si le programme est lancé en script (.py)
        base_path = os.path.dirname(os.path.abspath(__file__))
    return os.path.join(base_path, relative_path)

def assurer_fichier_utilisateur (nom_fichier, sous-dossier=None):
    if sous_dossier: